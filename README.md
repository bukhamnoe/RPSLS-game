# RPSLS-game smart contract

## คุณสมบัติหลัก
- **ป้องกันเงินค้างในสัญญา**: รับประกันว่าผู้เล่นสามารถถอนเงินได้หากเกมไม่เสร็จสมบูรณ์
- **กลไก Commit-Reveal**: ซ่อนตัวเลือกของผู้เล่นจนกว่าทุกคนจะยืนยัน
- **จัดการกับผู้เล่นที่ไม่ทำรายการ**: ป้องกันไม่ให้เกมติดขัดหากมีผู้เล่นไม่เข้าร่วม
- **ตัดสินผู้ชนะอย่างยุติธรรม**: เปรียบเทียบตัวเลือกหลังจากผู้เล่นเปิดเผยแล้ว

---

## 1. การป้องกันไม่ให้เงินถูกล็อกในสัญญา
- **forceGame** เป็นฟังก์ชันที่อนุญาตให้ผู้เล่นถอนเงินคืนได้หากฝ่ายตรงข้ามไม่ดำเนินการภายใน 10 นาทีหลังจากผู้เล่นคนเรียกเข้าร่วมเกม
- **Callback** เป็นฟังก์ชันที่ หากไม่มีผู้เล่นคนที่ 2 เข้าร่วมเกมใน 5 นาที ผู้เล่นคนที่ 1 สามารถกดถอนเงินคืนได้

---

## 2. การซ่อนตัวเลือกด้วย Commit-Reveal
- ผู้เล่นแต่ละคนส่ง **ค่าแฮชของตัวเลือก** ซึ่งสร้างขึ้นจากสูตร:
  
  ```solidity
  keccak256(abi.encodePacked(choice, salt))
  ```
  โดยผู้เล่นจะต้องกำหนด choice และ string ในฟังก์ชัน **getHash();**
  แล้วจึงนำค่าที่ได้มากรอกในฟังก์ชัน **commitMove();**
- วิธีนี้ช่วยให้ตัวเลือกยังคงเป็นความลับจนกว่าจะถึงรอบเปิดเผย
- ในรอบเปิดเผย ผู้เล่นต้องส่งค่าตัวเลือกจริงพร้อมค่า salt เพื่อตรวจสอบความถูกต้องกับค่าแฮชที่ได้ commit ไว้

---

## วิธีการใช้งาน
1. **Deploy smart contract** บนเครือข่าย Ethereum
2. ใช้account ที่อนุญาติให้เล่นเกมนี้ ลงชื่อและเงิน เพื่อเข้าร่วมเกม
3. ผู้เล่นแต่ละคนทำการ commit ตัวเลือกโดยส่งค่าแฮชและเงินเดิมพัน
4. เมื่อทั้งสองฝ่าย commit แล้ว ต้องเปิดเผยตัวเลือกของตน
5. สัญญาจะตัดสินผู้ชนะและโอนเงินรางวัลให้กับผู้ชนะ
6. หากฝ่ายใดฝ่ายหนึ่งไม่ดำเนินการในเวลาที่กำหนด สามารถกดคืนเงินได้(เหมือนsmart contrack นี้ไม่เคยเกิดขึ้น)

---

สัญญานี้ออกแบบมาเพื่อให้เกิดความยุติธรรม ป้องกันการโกง และสามารถจัดการกับกรณีที่ผู้เล่นขาดการติดต่อได้อย่างมีประสิทธิภาพ

